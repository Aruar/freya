//--------------------------------------------------------------
//               (c)2004-2007 Aurora Team Presents:             
//                  ___                                         
//                 /   |_   _ _ __ ___  _ __ __ _               
//                / /| | | | | '__/ _ \| '__/ _` |              
//               / ___ | |_| | | | (_) | | | (_| |              
//              /_/  |_|\____|_|  \___/|_|  \__,_|              
//                 http://aurora.deltaanime.net                 
//--------------------------------------------------------------
// Script Title: GvG Steward System	Author: Tsuyuki
//--------------------------------------------------------------
// Revision History: v1.0
//--------------------------------------------------------------
//	1.0 First version, converted from Aegis [Tsuyuki]
//--------------------------------------------------------------
// Additional Notes: * Official-certified / Aegis-certified *
//--------------------------------------------------------------


//--------------------------------------------------------------
// Documentation:
//--------------------------------------------------------------
// Guardian names are not correct right now. They're currently
// shown as Guardian 1, Guardian 2, Guardian 3, etc..
// They should be Guardian Archer, Guardian Soldier, etc..
// All castles are different so they will all need to be matched
// up correctly. Also, Guardian HP/Max HP values are not shown,
// the jA script engine doesn't seem to support retrieving the
// stat values.
//--------------------------------------------------------------


//--------------------------------------------------------------
// Al De Baran Guild Castle Stewards - [Tsuyuki]
//--------------------------------------------------------------

aldeg_cas01.gat,218,175,0	script	Alfredo	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Alfredo]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Alfredo]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Alfredo]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Alfredo, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Alfredo]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes "You invested "+getcastledata('@map$,4)+" times in last 1 day.";
		}
		mes "Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in last 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Alfredo]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Alfredo]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Alfredo]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Alfredo]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Alfredo]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Alfredo]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Alfredo]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Alfredo]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Alfredo]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Alfredo]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Alfredo]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Alfredo]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Alfredo]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","L1",'@no,1;
			mes "[Steward Alfredo]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Alfredo]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Alfredo]";
			mes "We are now hiring Kafra employee... Will you fire any current Kafra employee?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra Employee]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra Employee]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra Employee]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Alfredo]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_L0";
			setcastledata '@map$,9,0;
			mes "[Steward Alfredo]";
			mes "....";
			mes "I have discharged the Kafra employee... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Alfredo]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10,000 zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Alfredo]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Alfredo]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_L0";
				setcastledata '@map$,9,1;
				mes "[Steward Alfredo]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra Employee]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Alfredo]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Alfredo]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Alfredo]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Alfredo]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "aldeg_cas01.gat",113,223;
			end;
		case 2:
			mes "[Steward Alfredo]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

aldeg_cas02.gat,78,74,0	script	Chenchenlie	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Chenchenlie]";
		mes "I'm waiting for my master to return.";
		mes "If you wish to speak with him, you will have to wait as well. ";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Chenchenlie]";
		mes "I am loyal and I will follow my master ^ff0000"+getguildmaster('@gid)+"^000000. We are Guardians! We defend to the bitter end!";
		close;
	}
	mes "[Steward Chenchenlie]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Whatever you need, I am at your service. I will be faithful in my duties.";
	next;
	switch(select("castle briefing","Invest in commercial growth","Invest in safeguard","Summon Guardian","Employ / discharge storehouse staff","Go into Master's room")) {
	case 1:
		mes "[Steward Chenchenlie]";
		mes "castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in last 1 day.";
		}
		mes " Now, safeguard level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in last 1 day.^000000";
		}
		mes " ";
		mes "That is all, Master.";
		close;
	case 2:
		mes "[Steward Chenchenlie]";
		mes "If you raise commercial growth, the quantity of goods made by the guild will increase. So if you want a prosperous future, investment will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000But the commercial growth level of our castle is peaked at 100%. It doesn't need any more investment. As I expected you have a great acumen, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000But you already invested twice today so you cannot invest any more.^000000 I expect our riches to increase in growth level.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "Now the needed investment amount is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You've invested once today... if you wish to invest once more, ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Chenchenlie]";
				mes "I'm sorry but there is not enough zeny to invest. You will have to try again when you have the funds, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Chenchenlie]";
			mes "We finished the investment safely. I expect that our growth level will be increased by tomorrow.";
			close;
		case 2:
			mes "[Steward Chenchenlie]";
			mes "I'll do as you bid, my master... There is no hurry. We will do our best.";
			close;
		}
	case 3:
		mes "[Steward Chenchenlie]";
		mes "If you raise the safeguard, the durability of the Guardians and emperium will increase. So if you expect more defenses in battles, investment will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the safeguard level of our castle is peaked at 100%. It doesn't need any more investment. As I expected you have a great acumen, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000But you already invested twice today so you cannot invest any more.^000000 I expect our riches to increase in growth level.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "Now the needed investment amount is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You've invested once today... if you wish to invest once more, ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in safeguard.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Chenchenlie]";
				mes "I'm sorry but there is not enough zeny to invest. You will have to try again when you have the funds, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Chenchenlie]";
			mes "We finished the investment safely. I expect that the safeguard level will be increased by tomorrow.";
			close;
		case 2:
			mes "[Steward Chenchenlie]";
			mes "I'll do as you bid, my master... There is no hurry. We will do our best.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Chenchenlie]";
		mes "Will you summon a Guardian? It'll be a protector to defend us loyally.";
		mes "Please select a guardian to defend us.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Chenchenlie]";
		mes "Will you summon the chosen guardian? 10000 zeny is required to summon.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Chenchenlie]";
				mes "Master, we have not the resources to Summon the Guardian. If you want to accumulate them, you have to learn the Guild skill, We failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Chenchenlie]";
				mes "Master, you already have summoned that Guardian. We cannot summon another.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Chenchenlie]";
				mes "Well... I'm sorry but we don't have funds to summon the Guardian. We failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","L2",'@no,1;
			mes "[Steward Chenchenlie]";
			mes "We completed the summoning of the Guardian. Our defenses are now increased with it in place.";
			close;
		case 2:
			mes "[Steward Chenchenlie]";
			mes "I did as you ordered. But please remember if you the have money to spare, it'll be better to set it up.";
			close;
	}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Chenchenlie]";
			mes "Now about the Kafra staff... Will you discharge the Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can this be, Master?... I'll work harder if you're displeased... Please reconsider, Master.";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my god! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work harder... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Chenchenlie]";
				mes "Those Kafra are hard workers. I thought it would be best to keep the staff.";
				close;
			}
			disablenpc "AgitKafra_L1";
			setcastledata '@map$,9,0;
			mes "[Steward Chenchenlie]";
			mes "....";
			mes "Discharged Kafra staff... But... are you displeased with something?";
			close;
		} else {
			mes "[Steward Chenchenlie]";
			mes "Will you contract with the Kafra head office to hire Kafra staff in our castle?";
			mes "^ff0000 10000zeny is needed to hire. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Chenchenlie]";
					mes "Master, we cannot hire Kafra staff because we didn't make a contract with the Kafra head office. If you want to make a contract with the Kafra head office, you have to learn the Guild skill.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Chenchenlie]";
					mes "Well... I'm sorry but we don't have enough funds. We are unable to hire the Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_L1";
				setcastledata '@map$,9,1;
				mes "[Steward Chenchenlie]";
				mes "We finished making the contract with the Kafra head office successfully. We hired a Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I'm a dispatched Kafra from head office.";
				mes "I'll do my best to upkeep the reputation of Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Chenchenlie]";
				mes "The contract term of the hired Kafra staff is 1 month and after this term, you will have to pay an additional charge.";
				mes "It will be useful for our members.";
				close;
			case 2:
				mes "[Steward Chenchenlie]";
				mes "I did as you ordered, but some of our members will be unhappy. It will be better to hire a Kafra staff quickly.";
				close;
			}
		}
	case 6:
		mes "[Steward Chenchenlie]";
		mes "Do you want to visit the room where our valuables are stored?";
		mes "That room is restricted to you... you are the only one with access to it.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Chenchenlie]";
			mes "Please follow me, I will show you the secret passage.";
			mes "When you wish to return, pull this lever here...";
			warp "aldeg_cas02.gat",134,225;
			end;
		case 2:
			mes "[Steward Chenchenlie]";
			mes "Goods are produced once a day... if you don't make use of them, they will not produce.";
			mes "Therefore it would be better that you remove them over time for the Guild.";
			close;
		}
	}
}

aldeg_cas03.gat,110,118,0	script	Nahzarf	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Nahzarf]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Nahzarf]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Nahzarf]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Nahzarf, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Nahzarf]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Nahzarf]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Nahzarf]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Nahzarf]";
			mes "We finished the investment safely. I expect that our growth level will be increased by tomorrow.";
			close;
		case 2:
			mes "[Steward Nahzarf]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Nahzarf]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in safeguard.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Nahzarf]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Nahzarf]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Nahzarf]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Nahzarf]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Nahzarf]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Nahzarf]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Nahzarf]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Nahzarf]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","L3",'@no,1;
			mes "[Steward Nahzarf]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Nahzarf]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Nahzarf]";
			mes "We are now hiring Kafra Employee... Will you fire any current Kafra Employee?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra Employee]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra Employee]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra Employee]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Nahzarf]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_L2";
			setcastledata '@map$,9,0;
			mes "[Steward Nahzarf]";
			mes "....";
			mes "I have discharged the Kafra Employee... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Nahzarf]";
			mes "Will you contact Kafra head office to hire Kafra Employee in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Nahzarf]";
					mes "Master, we cannot hire Kafra Employee because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Nahzarf]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra Employee.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_L2";
				setcastledata '@map$,9,1;
				mes "[Steward Nahzarf]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra Employee.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra Employee]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Nahzarf]";
				mes "The Contract terms of the hired Kafra Employee is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Nahzarf]";
				mes "I done as you have commanded, but for the sake of our workers, it would be better to hire Kafra Employee immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Nahzarf]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Nahzarf]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "aldeg_cas03.gat",229,267;
			end;
		case 2:
			mes "[Steward Nahzarf]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

aldeg_cas04.gat,67,116,0	script	Brymhensen	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Brymhensen]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Brymhensen]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Brymhensen]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Brymhensen]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Brymhensen]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Brymhensen]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Brymhensen]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Brymhensen]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Brymhensen]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Brymhensen]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Brymhensen]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Brymhensen]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Brymhensen]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Brymhensen]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Brymhensen]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Brymhensen]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Brymhensen]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","L4",'@no,1;
			mes "[Steward Brymhensen]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Brymhensen]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Brymhensen]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Brymhensen]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_L3";
			setcastledata '@map$,9,0;
			mes "[Steward Brymhensen]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Brymhensen]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Brymhensen]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Brymhensen]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_L3";
				setcastledata '@map$,9,1;
				mes "[Steward Brymhensen]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Brymhensen]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Brymhensen]";
				mes "I done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Brymhensen]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Brymhensen]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "aldeg_cas04.gat",83,17;
			end;
		case 2:
			mes "[Steward Brymhensen]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

aldeg_cas05.gat,51,179,0	script	Esmarehk	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Blemhemsen]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Blemhemsen]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Blemhemsen]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Blemhemsen]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Blemhemsen]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Blemhemsen]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Blemhemsen]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Blemhemsen]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Blemhemsen]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Blemhemsen]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Blemhemsen]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Blemhemsen]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Blemhemsen]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Blemhemsen]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Blemhemsen]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Blemhemsen]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Blemhemsen]";
				mes "Well... I'm sorry but we don't have funds to summon the Guardian. We failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","L5",'@no,1;
			mes "[Steward Blemhemsen]";
			mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
			close;
		case 2:
			mes "[Steward Blemhemsen]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Blemhemsen]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Blemhemsen]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_L4";
			setcastledata '@map$,9,0;
			mes "[Steward Blemhemsen]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Blemhemsen]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Blemhemsen]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Blemhemsen]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_L4";
				setcastledata '@map$,9,1;
				mes "[Steward Blemhemsen]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Blemhemsen]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Blemhemsen]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Blemhemsen]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Blemhemsen]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "aldeg_cas05.gat",64,8;
			end;
		case 2:
			mes "[Steward Blemhemsen]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}


//--------------------------------------------------------------
// Geffen Guild Castle Stewards - [Tsuyuki]
//--------------------------------------------------------------

gefg_cas01.gat,40,48,5	script	Gnahcher	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Gnahcher]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Gnahcher]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Gnahcher]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Gnahcher]";
		mes "Please keep in mind master, since you own the number one castle";
		mes "you will have certain benefits other castles do not.";
		mes "Here is the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Gnahcher]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Gnahcher]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Gnahcher]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Gnahcher]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Gnahcher]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Gnahcher]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Gnahcher]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Gnahcher]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Gnahcher]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Gnahcher]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("summon.","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Gnahcher]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Gnahcher]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Gnahcher]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","B1",'@no,1;
			mes "[Steward Gnahcher]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Gnahcher]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Gnahcher]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Gnahcher]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_B0";
			setcastledata '@map$,9,0;
			mes "[Steward Gnahcher]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Gnahcher]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Gnahcher]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Gnahcher]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_B0";
				setcastledata '@map$,9,1;
				mes "[Steward Gnahcher]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Gnahcher]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Gnahcher]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Gnahcher]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Gnahcher]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "gefg_cas01.gat",152,117;
			end;
		case 2:
			mes "[Steward Gnahcher]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

gefg_cas02.gat,12,66,5	script	Esmarehk	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Esmarehk]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Esmarehk]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Esmarehk]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Esmarehk]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Esmarehk]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Esmarehk]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Esmarehk]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Esmarehk]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Esmarehk]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Esmarehk]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Esmarehk]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Esmarehk]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Esmarehk]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Esmarehk]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Esmarehk]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Esmarehk]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Esmarehk]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","B2",'@no,1;
			mes "[Steward Esmarehk]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Esmarehk]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Esmarehk]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Esmarehk]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_B1";
			setcastledata '@map$,9,0;
			mes "[Steward Esmarehk]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Esmarehk]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Esmarehk]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Esmarehk]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_B1";
				setcastledata '@map$,9,1;
				mes "[Steward Esmarehk]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Esmarehk]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Esmarehk]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Esmarehk]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Esmarehk]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "gefg_cas02.gat",145,115;
			end;
		case 2:
			mes "[Steward Esmarehk]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

gefg_cas03.gat,106,23,5	script	Jyang	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Jean]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Jean]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Jean]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Jean]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Jean]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Jean]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Jean]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Jean]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Jean]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Jean]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Jean]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Jean]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Jean]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Jean]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Jean]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Jean]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Jean]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","B3",'@no,1;
			mes "[Steward Jean]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Jean]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Jean]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Jean]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_B2";
			setcastledata '@map$,9,0;
			mes "[Steward Jean]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Jean]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Jean]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Jean]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_B2";
				setcastledata '@map$,9,1;
				mes "[Steward Jean]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Jean]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Jean]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Jean]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Jean]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "gefg_cas03.gat",275,289;
			end;
		case 2:
			mes "[Steward Jean]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

gefg_cas04.gat,73,46,3	script	Kellvahni	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Kellvahni]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Kellvahni]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Kellvahni]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Kellvahni]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Kellvahni]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Kellvahni]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Kellvahni]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Kellvahni]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Kellvahni]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Kellvahni]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Kellvahni]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Kellvahni]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Kellvahni]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Kellvahni]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Kellvahni]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Kellvahni]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Kellvahni]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","B4",'@no,1;
			mes "[Steward Kellvahni]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Kellvahni]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Kellvahni]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Kellvahni]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_B3";
			setcastledata '@map$,9,0;
			mes "[Steward Kellvahni]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Kellvahni]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Kellvahni]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Kellvahni]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_B3";
				setcastledata '@map$,9,1;
				mes "[Steward Kellvahni]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Kellvahni]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Kellvahni]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Kellvahni]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Kellvahni]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "gefg_cas04.gat",116,123;
			end;
		case 2:
			mes "[Steward Kellvahni]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

gefg_cas05.gat,70,52,3	script	Byohre	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Byohre]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Byohre]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Byohre]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Byohre]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Byohre]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Byohre]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Byohre]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Byohre]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Byohre]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Byohre]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Byohre]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Byohre]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Byohre]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Byohre]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Byohre]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Byohre]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Byohre]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","B5",'@no,1;
			mes "[Steward Byohre]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Byohre]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Byohre]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Byohre]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_B4";
			setcastledata '@map$,9,0;
			mes "[Steward Byohre]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Byohre]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Byohre]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Byohre]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_B4";
				setcastledata '@map$,9,1;
				mes "[Steward Byohre]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Byohre]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Byohre]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Byohre]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Byohre]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "gefg_cas05.gat",149,106;
			end;
		case 2:
			mes "[Steward Byohre]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}


//--------------------------------------------------------------
// Payon Guild Castle Stewards - [Tsuyuki]
//--------------------------------------------------------------

payg_cas01.gat,120,58,4	script	Kurunnadi	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Kurunnadi]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Kurunnadi]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Kurunnadi]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Kurunnadi]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Kurunnadi]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Kurunnadi]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Kurunnadi]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Kurunnadi]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Kurunnadi]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Kurunnadi]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Kurunnadi]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Kurunnadi]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Kurunnadi]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Kurunnadi]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Kurunnadi]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Kurunnadi]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Kurunnadi]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","C1",'@no,1;
			mes "[Steward Kurunnadi]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Kurunnadi]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Kurunnadi]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Kurunnadi]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_C0";
			setcastledata '@map$,9,0;
			mes "[Steward Kurunnadi]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Kurunnadi]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10,000 zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Kurunnadi]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Kurunnadi]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_C0";
				setcastledata '@map$,9,1;
				mes "[Steward Kurunnadi]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Kurunnadi]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Kurunnadi]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Kurunnadi]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Kurunnadi]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "payg_cas01.gat",295,8;
			end;
		case 2:
			mes "[Steward Kurunnadi]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

payg_cas02.gat,22,260,7	script	Cherieos	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Cherieos]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Cherieos]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Cherieos]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Cherieos]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Cherieos]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Cherieos]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Cherieos]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Cherieos]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Cherieos]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Cherieos]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Cherieos]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Cherieos]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Cherieos]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Cherieos]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Cherieos]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Cherieos]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Cherieos]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","C2",'@no,1;
			mes "[Steward Cherieos]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Cherieos]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Cherieos]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Alfredo]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_C1";
			setcastledata '@map$,9,0;
			mes "[Steward Alfredo]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Alfredo]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10,000 zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Cherieos]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Cherieos]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_C1";
				setcastledata '@map$,9,1;
				mes "[Steward Cherieos]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Cherieos]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Cherieos]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Cherieos]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Cherieos]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "payg_cas02.gat",141,149;
			end;
		case 2:
			mes "[Steward Cherieos]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

payg_cas03.gat,50,261,3	script	Gheriot	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Gheriot]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Gheriot]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Gheriot]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Gheriot]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Gheriot]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Gheriot]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Gheriot]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Gheriot]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Gheriot]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Gheriot]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Gheriot]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Gheriot]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Gheriot]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Gheriot]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Gheriot]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Gheriot]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Gheriot]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","C3",'@no,1;
			mes "[Steward Gheriot]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Gheriot]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Gheriot]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Gheriot]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_C2";
			setcastledata '@map$,9,0;
			mes "[Steward Gheriot]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Gheriot]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10,000 zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Gheriot]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Gheriot]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_C2";
				setcastledata '@map$,9,1;
				mes "[Steward Gheriot]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Gheriot]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Gheriot]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Gheriot]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Gheriot]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "payg_cas03.gat",163,167;
			end;
		case 2:
			mes "[Steward Gheriot]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

payg_cas04.gat,38,284,3	script	DJ	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward DJ]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward DJ]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward DJ]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward DJ]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward DJ]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward DJ]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward DJ]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward DJ]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward DJ]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward DJ]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward DJ]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward DJ]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward DJ]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward DJ]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward DJ]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward DJ]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward DJ]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","C4",'@no,1;
			mes "[Steward DJ]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward DJ]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward DJ]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward DJ]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_C3";
			setcastledata '@map$,9,0;
			mes "[Steward DJ]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward DJ]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10,000 zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward DJ]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward DJ]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_C3";
				setcastledata '@map$,9,1;
				mes "[Steward DJ]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward DJ]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward DJ]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward DJ]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward DJ]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "payg_cas04.gat",151,47;
			end;
		case 2:
			mes "[Steward DJ]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

payg_cas05.gat,277,249,3	script	Nahzarf	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Nahzarf]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Nahzarf]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Nahzarf]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Nahzarf]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Nahzarf]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Nahzarf]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Nahzarf]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Nahzarf]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Nahzarf]";
				mes "I'm sorry but there is not enough zeny to invest. You will have to try again when you have the funds, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Nahzarf]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Nahzarf]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Nahzarf]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Nahzarf]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Nahzarf]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Nahzarf]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Nahzarf]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","C5",'@no,1;
			mes "[Steward Nahzarf]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Nahzarf]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Nahzarf]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Nahzarf]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_C4";
			setcastledata '@map$,9,0;
			mes "[Steward Nahzarf]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Nahzarf]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10,000 zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Nahzarf]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Nahzarf]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_C4";
				setcastledata '@map$,9,1;
				mes "[Steward Nahzarf]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Nahzarf]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Nahzarf]";
				mes "I've done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Nahzarf]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Nahzarf]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "payg_cas05.gat",153,137;
			end;
		case 2:
			mes "[Steward Nahzarf]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}


//--------------------------------------------------------------
// Prontera Guild Castle Stewards - [Tsuyuki]
//--------------------------------------------------------------

prtg_cas01.gat,112,181,0	script	Ahvray	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Ahvray]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Ahvray]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Ahvray]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Ahvray, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Ahvray]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Ahvray]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Ahvray]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Ahvray]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Ahvray]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Ahvray]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Ahvray]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Ahvray]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Ahvray]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Ahvray]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Ahvray]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Ahvray]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Ahvray]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Ahvray]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","V1",'@no,1;
			mes "[Steward Ahvray]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Ahvray]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Ahvray]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Ahvray]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_V0";
			setcastledata '@map$,9,0;
			mes "[Steward Ahvray]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Ahvray]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Ahvray]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Ahvray]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_V0";
				setcastledata '@map$,9,1;
				mes "[Steward Ahvray]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Ahvray]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Ahvray]";
				mes "I done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Ahvray]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Ahvray]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "prtg_cas01.gat",15,209;
			end;
		case 2:
			mes "[Steward Ahvray]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

prtg_cas02.gat,94,61,4	script	Roy	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Roy]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Roy]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Roy]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Roy, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Roy]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Roy]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity .";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "Now needed investment amount is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Roy]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Roy]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Roy]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Roy]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in Castle Defenses.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Roy]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Roy]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Roy]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Roy]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Roy]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Roy]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Roy]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Roy]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","V2",'@no,1;
			mes "[Steward Roy]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Roy]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Roy]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Roy]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_V1";
			setcastledata '@map$,9,0;
			mes "[Steward Roy]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Roy]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Roy]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Roy]";
					mes "Well... I'm sorry but we don't have enough funds to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_V1";
				setcastledata '@map$,9,1;
				mes "[Steward Roy]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Roy]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Roy]";
				mes "I done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Roy]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Roy]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "prtg_cas02.gat",207,229;
			end;
		case 2:
			mes "[Steward Roy]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

prtg_cas03.gat,51,100,4	script	Sttick	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Sttick]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Sttick]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Sttick]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Sttick, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Sttick]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Sttick]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Sttick]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Sttick]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Sttick]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Sttick]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in safeguard.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Sttick]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Sttick]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Sttick]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Setting (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - No Setting";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Setting (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - No Setting";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Setting (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - No Setting";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Setting (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - No Setting";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Setting (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - No Setting";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Setting (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - No Setting";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Setting (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - No Setting";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Setting (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - No Setting";
		}
		mes "[Steward Sttick]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Sttick]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Sttick]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Sttick]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Sttick]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","V3",'@no,1;
			mes "[Steward Sttick]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Sttick]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Sttick]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Sttick]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_V2";
			setcastledata '@map$,9,0;
			mes "[Steward Sttick]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Sttick]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Sttick]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Sttick]";
					mes "Well... I'm sorry but we don't have enough fund. We failed to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_V2";
				setcastledata '@map$,9,1;
				mes "[Steward Sttick]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Sttick]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Sttick]";
				mes "I done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Sttick]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Sttick]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "prtg_cas03.gat",190,130;
			end;
		case 2:
			mes "[Steward Sttick]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

prtg_cas04.gat,259,265,4	script	Van Dreth	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Van Dreth]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Van Dreth]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Van Dreth]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Van Dreth, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Van Dreth]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Van Dreth]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Van Dreth]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Van Dreth]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Van Dreth]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Van Dreth]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in safeguard.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Van Dreth]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Van Dreth]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Van Dreth]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Van Dreth]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Van Dreth]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Van Dreth]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Van Dreth]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Van Dreth]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","V4",'@no,1;
			mes "[Steward Van Dreth]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Van Dreth]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Van Dreth]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Van Dreth]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_V3";
			setcastledata '@map$,9,0;
			mes "[Steward Van Dreth]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Van Dreth]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Van Dreth]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Van Dreth]";
					mes "Well... I'm sorry but we don't have enough fund. We failed to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_V3";
				setcastledata '@map$,9,1;
				mes "[Steward Van Dreth]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Van Dreth]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Van Dreth]";
				mes "I done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Van Dreth]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Van Dreth]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "prtg_cas04.gat",275,160;
			end;
		case 2:
			mes "[Steward Van Dreth]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}

prtg_cas05.gat,36,37,4	script	Raynor	55,{

	set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
	set '@gid,getcastledata('@map$,1);
	if ('@gid == 0 || getcharid(2) != '@gid) {
		mes "[Steward Raynor]";
		mes "I have been waiting for a master to fulfill my destiny.";
		mes "Brave soul... fate will guide you towards your future...";
		close;
	}
	if (getcharid(0) != getguildmasterid('@gid)) {
		mes "[Steward Raynor]";
		mes "No matter how much you pester me, I'll still follow my master ^ff0000"+getguildmaster('@gid)+"^000000. Where are Guardians?! Send these ruffians away right now!";
		close;
	}
	mes "[Steward Raynor]";
	mes "Welcome. My honorable master, ^ff0000"+getguildmaster('@gid)+"^000000...";
	mes "Your humble servent, Raynor, is here to serve you.";
	next;
	switch(select("Castle briefing","Invest in commercial growth","Invest in Castle Defenses","Summon Guardian","Employ / discharge a storehouse staff member","Go into Master's room")) {
	case 1:
		mes "[Steward Raynor]";
		mes "I will report the Castle briefing, Master.";
		mes " ";
		mes " ^0000ffNow, the commercial growth level is "+getcastledata('@map$,2)+".";
		if (getcastledata('@map$,4) > 0) {
			mes " You invested "+getcastledata('@map$,4)+" times in past 1 day.";
		}
		mes " Now, the Castle Defense level is "+getcastledata('@map$,3)+".^000000";
		if (getcastledata('@map$,5) > 0) {
			mes " ^0000ff- You invested "+getcastledata('@map$,5)+" times in past 1 day.^000000";
		}
		mes " ";
		mes "That's all to report, Master.";
		close;
	case 2:
		mes "[Steward Raynor]";
		mes "If you invest in commercial growth, the quantity of goods made by the guild will increase. Therfore, if you consider our future, investments will be a necessity.";
		mes " ";
		mes "Initially, you are able to invest just once but if you pay more money, you will be able to invest twice.";
		if (getcastledata('@map$,2) == 100) {
			mes " ";
			mes "^ff0000The commercial growth level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great economist like you, Master.^000000";
			close;
		}
		if (getcastledata('@map$,4) == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect riches of the guild to grow at a high rate.";
			close;
		}
		set '@count,getcastledata('@map$,4);
		set '@val,getcastledata('@map$,2);
		set '@tmp,('@val - '@count) / 5;
		set '@gold,5000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if (getcastledata('@map$,4) == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in commercial growth","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Raynor]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,4,'@count + 1;
			set '@tmp,getcastledata('@map$,2) + 1;
			if (getgdskilllv(getcharid(2),GD_DEVELOPMENT) == 1 && (rand(100) >= 50) && ('@tmp < 100)) {
				set '@tmp,'@tmp + 1;
			}
			setcastledata '@map$,2,'@tmp;
			mes "[Steward Raynor]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Raynor]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 3:
		mes "[Steward Raynor]";
		mes "If you raise Castle Defenses, the durability of Guardians and the Emperium will increase. Therefore, if you consider our coming battles, some investment in this area will be required.";
		mes " ";
		mes "Originally you can invest just once but if you pay more money, you can invest twice.";
		set '@val,getcastledata('@map$,3);
		if ('@val == 100) {
			mes " ";
			mes "^ff0000But the Castle Defense level of our Castle is at it's highest, 100%. No more investments are needed. Just as I have expected from a great strategist like you, Master.^000000";
			close;
		}
		set '@count,getcastledata('@map$,5);
		if ('@count == 2) {
			mes " ";
			mes "^ff0000You have already invested twice today. You cannot invest any more.^000000 I expect the Defenses of the guild to grow at a high rate.";
			close;
		}
		set '@tmp,('@val - '@count) / 5;
		set '@gold,10000 * (1 + (1 + '@tmp) * '@tmp / 2) * (1 + 3 * '@count);
		if ('@count == 0) {
			mes " ";
			mes "The current investment amount required is ^ff0000"+'@gold+"^000000 zeny. Will you invest?";
		} else {
			mes " ";
			mes "You have already invested once. Do you wish to invest one more time? ^ff0000"+'@gold+"^000000 more zeny will be needed.";
		}
		next;
		switch(select("Invest in safeguard.","Cancel")) {
		case 1:
			if (Zeny < '@gold) {
				mes "[Steward Raynor]";
				mes "I'm sorry but there is not enough zeny to invest in the reserves of guild. You have failed to invest, Master.";
				close;
			}
			set Zeny,Zeny - '@gold;
			setcastledata '@map$,5,'@count + 1;
			set '@tmp,getcastledata('@map$,3) + 1;
			setcastledata '@map$,3,'@tmp;
			mes "[Steward Raynor]";
			mes "We have finished investing safely. I expect in our coming days, the growth level will increase.";
			close;
		case 2:
			mes "[Steward Raynor]";
			mes "I'll do as you have instructed my master... There is no hurry. There is nothing we can not accomplish.";
			close;
		}
	case 4:
		set '@name1$,"Guardian 1";
		set '@name2$,"Guardian 2";
		set '@name3$,"Guardian 3";
		set '@name4$,"Guardian 4";
		set '@name5$,"Guardian 5";
		set '@name6$,"Guardian 6";
		set '@name7$,"Guardian 7";
		set '@name8$,"Guardian 8";
		if (getcastledata('@map$,10)) {
			set '@name1$,'@name1$ + " - Implemented (";
			// set '@name1$,'@name1$ + getcastledata('@map$,10,HP);
			set '@name1$,'@name1$ + " / ";
			set '@name1$,'@name1$ + getcastledata('@map$,10,MAXHP);
			set '@name1$,'@name1$ + ")";
		} else {
			set '@name1$,'@name1$ + " - Not implemented";
		}
		if (getcastledata('@map$,11)) {
			set '@name2$,'@name2$ + " - Implemented (";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,HP);
			set '@name2$,'@name2$ + " / ";
			// set '@name2$,'@name2$ + getcastledata('@map$,11,MAXHP);
			set '@name2$,'@name2$ + ")";
		} else {
			set '@name2$,'@name2$ + " - Not implemented";
		}
		if (getcastledata('@map$,12)) {
			set '@name3$,'@name3$ + " - Implemented (";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,HP);
			set '@name3$,'@name3$ + " / ";
			// set '@name3$,'@name3$ + getcastledata('@map$,12,MAXHP);
			set '@name3$,'@name3$ + ")";
		} else {
			set '@name3$,'@name3$ + " - Not implemented";
		}
		if (getcastledata('@map$,13)) {
			set '@name4$,'@name4$ + " - Implemented (";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,HP);
			set '@name4$,'@name4$ + " / ";
			// set '@name4$,'@name4$ + getcastledata('@map$,13,MAXHP);
			set '@name4$,'@name4$ + ")";
		} else {
			set '@name4$,'@name4$ + " - Not implemented";
		}
		if (getcastledata('@map$,14)) {
			set '@name5$,'@name5$ + " - Implemented (";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,HP);
			set '@name5$,'@name5$ + " / ";
			// set '@name5$,'@name5$ + getcastledata('@map$,14,MAXHP);
			set '@name5$,'@name5$ + ")";
		} else {
			set '@name5$,'@name5$ + " - Not implemented";
		}
		if (getcastledata('@map$,15)) {
			set '@name6$,'@name6$ + " - Implemented (";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,HP);
			set '@name6$,'@name6$ + " / ";
			// set '@name6$,'@name6$ + getcastledata('@map$,15,MAXHP);
			set '@name6$,'@name6$ + ")";
		} else {
			set '@name6$,'@name6$ + " - Not implemented";
		}
		if (getcastledata('@map$,16)) {
			set '@name7$,'@name7$ + " - Implemented (";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,HP);
			set '@name7$,'@name7$ + " / ";
			// set '@name7$,'@name7$ + getcastledata('@map$,16,MAXHP);
			set '@name7$,'@name7$ + ")";
		} else {
			set '@name7$,'@name7$ + " - Not implemented";
		}
		if (getcastledata('@map$,17)) {
			set '@name8$,'@name8$ + " - Implemented (";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,HP);
			set '@name8$,'@name8$ + " / ";
			// set '@name8$,'@name8$ + getcastledata('@map$,17,MAXHP);
			set '@name8$,'@name8$ + ")";
		} else {
			set '@name8$,'@name8$ + " - Not implemented";
		}
		mes "[Steward Raynor]";
		mes "Do you still want to summon a Guardian? It'll be a protector to defend us to the end.";
		mes "Choose a Guardian to summon.";
		next;
		switch(select("'@name1$,'@name2$,'@name3$,'@name4$,'@name5$,'@name6$,'@name7$,'@name8$")) {
		case 1:
			set '@no,10;
			break;
		case 2:
			set '@no,11;
			break;
		case 3:
			set '@no,12;
			break;
		case 4:
			set '@no,13;
			break;
		case 5:
			set '@no,14;
			break;
		case 6:
			set '@no,15;
			break;
		case 7:
			set '@no,16;
			break;
		case 8:
			set '@no,17;
			break;
		}
		mes "[Steward Raynor]";
		mes "Do you wish to summon the chosen guardian? 10,000 zeny is required to summon it.";
		next;
		switch(select("Summon","Cancel")) {
		case 1:
			if (getgdskilllv(getcharid(2),GD_GUARDIANRESEARCH) == 0) {
				mes "[Steward Raynor]";
				mes "Master, we do not have any research materials to summon the Guardian. If you want to accumulate knowledge for Guardians, you have to learn the Guild skill first, We have failed to summon the Guardian.";
				close;
			}
			if (getcastledata('@map$,'@no)) {
				mes "[Steward Raynor]";
				mes "Master, you have already have that Guardian. You cannot summon any more.";
				close;
			}
			if (Zeny < 10000) {
				mes "[Steward Raynor]";
				mes "Well... I'm sorry but we don't have enough funds to summon the Guardian. We have failed to summon the Guardian.";
				close;
			}
			set Zeny,Zeny - 10000;
			setcastledata '@map$,'@no,1;
			callfunc "F_GuardianCall","V5",'@no,1;
			mes "[Steward Raynor]";
			mes "We have successfully summoned the Guardian. We now have our strong force to defend us!";
			close;
		case 2:
			mes "[Steward Raynor]";
			mes "I have done as you have commanded, but please remember if you have money to spare, it will be better if we use a Guardian.";
			close;
		}
	case 5:
		if (getcastledata('@map$,9)) {
			mes "[Steward Raynor]";
			mes "We are now hiring Kafra staff... Will you fire any current Kafra staff?";
			next;
			switch(select("Discharge","Cancel")) {
			case 1:
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "I worked so hard... How can you do that, Master?... Please... Please reconsider... Check it again, Master... Please...";
				next;
				switch(select("Discharge","Cancel")) {
				case 1:
					mes "[Hired Kafra staff]";
					mes "Oh, my goodness! This is nonsense!";
					next;
					cutin "kafra_01",255;
					break;
				case 2:
					mes "[Hired Kafra staff]";
					mes "I'll work hard for you... Thank you!";
					close;
				}
				break;
			case 2:
				mes "[Steward Raynor]";
				mes "She worked hard in my opinion. It was a good decision to keep her.";
				close;
			}
			disablenpc "AgitKafra_V4";
			setcastledata '@map$,9,0;
			mes "[Steward Raynor]";
			mes "....";
			mes "I have discharged the Kafra staff... But... are you dissatisfied with the decision?";
			close;
		} else {
			mes "[Steward Raynor]";
			mes "Will you contact Kafra head office to hire Kafra staff in our Castle?";
			mes "^ff0000 10000zeny is required for their services. ";
			next;
			switch(select("Hire.","Cancel")) {
			case 1:
				if (getgdskilllv(getcharid(2),GD_KAFRACONTACT) == 0) {
					mes "[Steward Raynor]";
					mes "Master, we cannot hire Kafra staff because we have not established a contract with Kafra head office. If you want to establish a contract with Kafra head office, you have to learn Guild skill first.";
					close;
				}
				if (Zeny < 10000) {
					mes "[Steward Raynor]";
					mes "Well... I'm sorry but we don't have enough fund. We failed to hire Kafra staff.";
					close;
				}
				set Zeny,Zeny - 10000;
				enablenpc "AgitKafra_V4";
				setcastledata '@map$,9,1;
				mes "[Steward Raynor]";
				mes "We have completed our task in establishing a contract with Kafra head office and hired Kafra staff.";
				next;
				cutin "kafra_01",2;
				mes "[Hired Kafra staff]";
				mes "How do you do? I was dispatched from head office.";
				mes "I'll do my best to not tarnish reputation of the Guild.";
				next;
				cutin "kafra_01",255;
				mes "[Steward Raynor]";
				mes "The Contract terms of the hired Kafra staff is for 1 month and after this term, you will need to to pay an additional charge.";
				mes "This will be good for our workers.";
				close;
			case 2:
				mes "[Steward Raynor]";
				mes "I done as you have commanded, but for the sake of our workers, it would be better to hire Kafra staff immediately.";
				close;
			}
		}
	case 6:
		mes "[Steward Raynor]";
		mes "Do you wish to go to the Master's Room.";
		mes "That place is for only for you... no one else can enter the room.";
		next;
		switch(select("Go into Master's room.","Cancel")) {
		case 1:
			mes "[Steward Raynor]";
			mes "I'll show you the secret path. Follow me...please.";
			mes "When you want to return here, please press the secret switch.";
			warp "prtg_cas05.gat",281,176;
			end;
		case 2:
			mes "[Steward Raynor]";
			mes "Goods are produced once a day... if you don't remove them in time, they will not be produced anymore.";
			mes "Therefore, it will be better if you check up on them from time to time.";
			close;
		}
	}
}
